name: Update Player Data

on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 UTC
    - cron: '0 3 * * *'
  workflow_dispatch:  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

jobs:
  update-data:jobs:
  update:
    runs-on: ubuntu-latest
    # –î–û–ë–ê–í–¨–¢–ï –≠–¢–û–¢ –ë–õ–û–ö:
    permissions:
      contents: write  # –î–∞—ë–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    steps:
    - name: üì• Checkout repository
      uses: actions/checkout@v3
      # –ò –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω —Å—é–¥–∞:
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    ... # –æ—Å—Ç–∞–ª—å–Ω—ã–µ —à–∞–≥–∏
    runs-on: ubuntu-latest
    
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests beautifulsoup4
    
    - name: Run player data update
      run: |
        cd scripts
        python core_parser.py
    
    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add data/ web/
        git diff --quiet && git diff --staged --quiet || git commit -m "Auto-update: player data $(date +'%Y-%m-%d %H:%M')"
        git push
